<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>parser.ml &mdash; Coverage report</title>
    <meta name="description" content="97.75% coverage in lib/parser.ml">
    <link rel="stylesheet" href="../coverage.css"/>
    <script src="../highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div id="header">
      <h1>
        <a href="../index.html">
          <span class="dirname">lib/</span>parser.ml
        </a>
      </h1>
      <h2>97.75%</h2>
    </div>
    <div id="navbar">
      <span class="some-visited" style="top:1.74%"></span>
      <span class="unvisited" style="top:3.76%"></span>
      <span class="some-visited" style="top:4.97%"></span>
      <span class="some-visited" style="top:5.50%"></span>
      <span class="unvisited" style="top:11.54%"></span>
      <span class="some-visited" style="top:18.66%"></span>
      <span class="unvisited" style="top:35.57%"></span>
    </div>
    <div id="report">
      <div id="lines-layer">
        <pre>
<a id="L1"></a><span > </span>
<a id="L2"></a><span > </span>
<a id="L3"></a><span > </span>
<a id="L4"></a><span > </span>
<a id="L5"></a><span > </span>
<a id="L6"></a><span > </span>
<a id="L7"></a><span > </span>
<a id="L8"></a><span > </span>
<a id="L9"></a><span > </span>
<a id="L10"></a><span class="visited"> </span>
<a id="L11"></a><span > </span>
<a id="L12"></a><span > </span>
<a id="L13"></a><span class="some-visited"> </span>
<a id="L14"></a><span class="visited"> </span>
<a id="L15"></a><span > </span>
<a id="L16"></a><span > </span>
<a id="L17"></a><span > </span>
<a id="L18"></a><span class="visited"> </span>
<a id="L19"></a><span class="visited"> </span>
<a id="L20"></a><span > </span>
<a id="L21"></a><span > </span>
<a id="L22"></a><span > </span>
<a id="L23"></a><span class="visited"> </span>
<a id="L24"></a><span class="visited"> </span>
<a id="L25"></a><span > </span>
<a id="L26"></a><span > </span>
<a id="L27"></a><span > </span>
<a id="L28"></a><span class="unvisited"> </span>
<a id="L29"></a><span class="visited"> </span>
<a id="L30"></a><span > </span>
<a id="L31"></a><span > </span>
<a id="L32"></a><span > </span>
<a id="L33"></a><span class="visited"> </span>
<a id="L34"></a><span > </span>
<a id="L35"></a><span > </span>
<a id="L36"></a><span > </span>
<a id="L37"></a><span class="some-visited"> </span>
<a id="L38"></a><span > </span>
<a id="L39"></a><span > </span>
<a id="L40"></a><span > </span>
<a id="L41"></a><span class="some-visited"> </span>
<a id="L42"></a><span class="visited"> </span>
<a id="L43"></a><span > </span>
<a id="L44"></a><span > </span>
<a id="L45"></a><span > </span>
<a id="L46"></a><span class="visited"> </span>
<a id="L47"></a><span class="visited"> </span>
<a id="L48"></a><span > </span>
<a id="L49"></a><span > </span>
<a id="L50"></a><span class="visited"> </span>
<a id="L51"></a><span class="visited"> </span>
<a id="L52"></a><span class="visited"> </span>
<a id="L53"></a><span class="visited"> </span>
<a id="L54"></a><span class="visited"> </span>
<a id="L55"></a><span class="visited"> </span>
<a id="L56"></a><span class="visited"> </span>
<a id="L57"></a><span class="visited"> </span>
<a id="L58"></a><span class="visited"> </span>
<a id="L59"></a><span class="visited"> </span>
<a id="L60"></a><span > </span>
<a id="L61"></a><span > </span>
<a id="L62"></a><span > </span>
<a id="L63"></a><span class="visited"> </span>
<a id="L64"></a><span class="visited"> </span>
<a id="L65"></a><span class="visited"> </span>
<a id="L66"></a><span > </span>
<a id="L67"></a><span > </span>
<a id="L68"></a><span > </span>
<a id="L69"></a><span class="visited"> </span>
<a id="L70"></a><span > </span>
<a id="L71"></a><span > </span>
<a id="L72"></a><span class="visited"> </span>
<a id="L73"></a><span class="visited"> </span>
<a id="L74"></a><span > </span>
<a id="L75"></a><span > </span>
<a id="L76"></a><span > </span>
<a id="L77"></a><span class="visited"> </span>
<a id="L78"></a><span class="visited"> </span>
<a id="L79"></a><span > </span>
<a id="L80"></a><span class="visited"> </span>
<a id="L81"></a><span > </span>
<a id="L82"></a><span class="visited"> </span>
<a id="L83"></a><span class="visited"> </span>
<a id="L84"></a><span class="visited"> </span>
<a id="L85"></a><span class="visited"> </span>
<a id="L86"></a><span class="unvisited"> </span>
<a id="L87"></a><span class="visited"> </span>
<a id="L88"></a><span > </span>
<a id="L89"></a><span > </span>
<a id="L90"></a><span > </span>
<a id="L91"></a><span > </span>
<a id="L92"></a><span class="visited"> </span>
<a id="L93"></a><span > </span>
<a id="L94"></a><span class="visited"> </span>
<a id="L95"></a><span > </span>
<a id="L96"></a><span > </span>
<a id="L97"></a><span > </span>
<a id="L98"></a><span > </span>
<a id="L99"></a><span class="visited"> </span>
<a id="L100"></a><span class="visited"> </span>
<a id="L101"></a><span class="visited"> </span>
<a id="L102"></a><span class="visited"> </span>
<a id="L103"></a><span > </span>
<a id="L104"></a><span > </span>
<a id="L105"></a><span > </span>
<a id="L106"></a><span class="visited"> </span>
<a id="L107"></a><span class="visited"> </span>
<a id="L108"></a><span class="visited"> </span>
<a id="L109"></a><span class="visited"> </span>
<a id="L110"></a><span class="visited"> </span>
<a id="L111"></a><span class="visited"> </span>
<a id="L112"></a><span class="visited"> </span>
<a id="L113"></a><span > </span>
<a id="L114"></a><span > </span>
<a id="L115"></a><span > </span>
<a id="L116"></a><span > </span>
<a id="L117"></a><span > </span>
<a id="L118"></a><span > </span>
<a id="L119"></a><span > </span>
<a id="L120"></a><span > </span>
<a id="L121"></a><span > </span>
<a id="L122"></a><span > </span>
<a id="L123"></a><span > </span>
<a id="L124"></a><span > </span>
<a id="L125"></a><span > </span>
<a id="L126"></a><span > </span>
<a id="L127"></a><span class="visited"> </span>
<a id="L128"></a><span class="visited"> </span>
<a id="L129"></a><span class="visited"> </span>
<a id="L130"></a><span class="visited"> </span>
<a id="L131"></a><span class="visited"> </span>
<a id="L132"></a><span > </span>
<a id="L133"></a><span > </span>
<a id="L134"></a><span class="visited"> </span>
<a id="L135"></a><span class="visited"> </span>
<a id="L136"></a><span > </span>
<a id="L137"></a><span > </span>
<a id="L138"></a><span > </span>
<a id="L139"></a><span class="some-visited"> </span>
<a id="L140"></a><span > </span>
<a id="L141"></a><span > </span>
<a id="L142"></a><span class="visited"> </span>
<a id="L143"></a><span class="visited"> </span>
<a id="L144"></a><span class="visited"> </span>
<a id="L145"></a><span > </span>
<a id="L146"></a><span > </span>
<a id="L147"></a><span > </span>
<a id="L148"></a><span class="visited"> </span>
<a id="L149"></a><span class="visited"> </span>
<a id="L150"></a><span class="visited"> </span>
<a id="L151"></a><span class="visited"> </span>
<a id="L152"></a><span class="visited"> </span>
<a id="L153"></a><span class="visited"> </span>
<a id="L154"></a><span > </span>
<a id="L155"></a><span > </span>
<a id="L156"></a><span class="visited"> </span>
<a id="L157"></a><span class="visited"> </span>
<a id="L158"></a><span > </span>
<a id="L159"></a><span class="visited"> </span>
<a id="L160"></a><span class="visited"> </span>
<a id="L161"></a><span class="visited"> </span>
<a id="L162"></a><span class="visited"> </span>
<a id="L163"></a><span class="visited"> </span>
<a id="L164"></a><span class="visited"> </span>
<a id="L165"></a><span > </span>
<a id="L166"></a><span > </span>
<a id="L167"></a><span > </span>
<a id="L168"></a><span class="visited"> </span>
<a id="L169"></a><span > </span>
<a id="L170"></a><span > </span>
<a id="L171"></a><span class="visited"> </span>
<a id="L172"></a><span class="visited"> </span>
<a id="L173"></a><span class="visited"> </span>
<a id="L174"></a><span class="visited"> </span>
<a id="L175"></a><span > </span>
<a id="L176"></a><span > </span>
<a id="L177"></a><span > </span>
<a id="L178"></a><span class="visited"> </span>
<a id="L179"></a><span class="visited"> </span>
<a id="L180"></a><span class="visited"> </span>
<a id="L181"></a><span class="visited"> </span>
<a id="L182"></a><span class="visited"> </span>
<a id="L183"></a><span class="visited"> </span>
<a id="L184"></a><span class="visited"> </span>
<a id="L185"></a><span > </span>
<a id="L186"></a><span class="visited"> </span>
<a id="L187"></a><span class="visited"> </span>
<a id="L188"></a><span > </span>
<a id="L189"></a><span > </span>
<a id="L190"></a><span > </span>
<a id="L191"></a><span class="visited"> </span>
<a id="L192"></a><span > </span>
<a id="L193"></a><span class="visited"> </span>
<a id="L194"></a><span class="visited"> </span>
<a id="L195"></a><span class="visited"> </span>
<a id="L196"></a><span class="visited"> </span>
<a id="L197"></a><span class="visited"> </span>
<a id="L198"></a><span class="visited"> </span>
<a id="L199"></a><span > </span>
<a id="L200"></a><span > </span>
<a id="L201"></a><span class="visited"> </span>
<a id="L202"></a><span > </span>
<a id="L203"></a><span class="visited"> </span>
<a id="L204"></a><span > </span>
<a id="L205"></a><span class="visited"> </span>
<a id="L206"></a><span class="visited"> </span>
<a id="L207"></a><span class="visited"> </span>
<a id="L208"></a><span class="visited"> </span>
<a id="L209"></a><span > </span>
<a id="L210"></a><span > </span>
<a id="L211"></a><span class="visited"> </span>
<a id="L212"></a><span > </span>
<a id="L213"></a><span class="visited"> </span>
<a id="L214"></a><span class="visited"> </span>
<a id="L215"></a><span > </span>
<a id="L216"></a><span > </span>
<a id="L217"></a><span class="visited"> </span>
<a id="L218"></a><span > </span>
<a id="L219"></a><span class="visited"> </span>
<a id="L220"></a><span class="visited"> </span>
<a id="L221"></a><span > </span>
<a id="L222"></a><span class="visited"> </span>
<a id="L223"></a><span class="visited"> </span>
<a id="L224"></a><span class="visited"> </span>
<a id="L225"></a><span > </span>
<a id="L226"></a><span class="visited"> </span>
<a id="L227"></a><span > </span>
<a id="L228"></a><span class="visited"> </span>
<a id="L229"></a><span > </span>
<a id="L230"></a><span > </span>
<a id="L231"></a><span > </span>
<a id="L232"></a><span class="visited"> </span>
<a id="L233"></a><span class="visited"> </span>
<a id="L234"></a><span class="visited"> </span>
<a id="L235"></a><span > </span>
<a id="L236"></a><span > </span>
<a id="L237"></a><span > </span>
<a id="L238"></a><span class="visited"> </span>
<a id="L239"></a><span class="visited"> </span>
<a id="L240"></a><span class="visited"> </span>
<a id="L241"></a><span > </span>
<a id="L242"></a><span > </span>
<a id="L243"></a><span > </span>
<a id="L244"></a><span > </span>
<a id="L245"></a><span class="visited"> </span>
<a id="L246"></a><span > </span>
<a id="L247"></a><span > </span>
<a id="L248"></a><span > </span>
<a id="L249"></a><span class="visited"> </span>
<a id="L250"></a><span > </span>
<a id="L251"></a><span class="visited"> </span>
<a id="L252"></a><span class="visited"> </span>
<a id="L253"></a><span > </span>
<a id="L254"></a><span > </span>
<a id="L255"></a><span > </span>
<a id="L256"></a><span class="visited"> </span>
<a id="L257"></a><span > </span>
<a id="L258"></a><span class="visited"> </span>
<a id="L259"></a><span > </span>
<a id="L260"></a><span > </span>
<a id="L261"></a><span > </span>
<a id="L262"></a><span > </span>
<a id="L263"></a><span class="visited"> </span>
<a id="L264"></a><span class="visited"> </span>
<a id="L265"></a><span class="unvisited"> </span>
<a id="L266"></a><span > </span>
<a id="L267"></a><span > </span>
<a id="L268"></a><span > </span>
<a id="L269"></a><span > </span>
<a id="L270"></a><span > </span>
<a id="L271"></a><span class="visited"> </span>
<a id="L272"></a><span class="visited"> </span>
<a id="L273"></a><span > </span>
<a id="L274"></a><span > </span>
<a id="L275"></a><span > </span>
<a id="L276"></a><span class="visited"> </span>
<a id="L277"></a><span class="visited"> </span>
<a id="L278"></a><span > </span>
<a id="L279"></a><span > </span>
<a id="L280"></a><span > </span>
<a id="L281"></a><span class="visited"> </span>
<a id="L282"></a><span class="visited"> </span>
<a id="L283"></a><span > </span>
<a id="L284"></a><span > </span>
<a id="L285"></a><span > </span>
<a id="L286"></a><span class="visited"> </span>
<a id="L287"></a><span class="visited"> </span>
<a id="L288"></a><span > </span>
<a id="L289"></a><span > </span>
<a id="L290"></a><span > </span>
<a id="L291"></a><span class="visited"> </span>
<a id="L292"></a><span class="visited"> </span>
<a id="L293"></a><span > </span>
<a id="L294"></a><span > </span>
<a id="L295"></a><span > </span>
<a id="L296"></a><span > </span>
<a id="L297"></a><span > </span>
<a id="L298"></a><span class="visited"> </span>
<a id="L299"></a><span class="visited"> </span>
<a id="L300"></a><span class="visited"> </span>
<a id="L301"></a><span > </span>
<a id="L302"></a><span > </span>
<a id="L303"></a><span > </span>
<a id="L304"></a><span class="visited"> </span>
<a id="L305"></a><span class="visited"> </span>
<a id="L306"></a><span class="visited"> </span>
<a id="L307"></a><span > </span>
<a id="L308"></a><span > </span>
<a id="L309"></a><span > </span>
<a id="L310"></a><span class="visited"> </span>
<a id="L311"></a><span class="visited"> </span>
<a id="L312"></a><span class="visited"> </span>
<a id="L313"></a><span > </span>
<a id="L314"></a><span > </span>
<a id="L315"></a><span > </span>
<a id="L316"></a><span class="visited"> </span>
<a id="L317"></a><span class="visited"> </span>
<a id="L318"></a><span class="visited"> </span>
<a id="L319"></a><span > </span>
<a id="L320"></a><span > </span>
<a id="L321"></a><span > </span>
<a id="L322"></a><span > </span>
<a id="L323"></a><span > </span>
<a id="L324"></a><span > </span>
<a id="L325"></a><span > </span>
<a id="L326"></a><span class="visited"> </span>
<a id="L327"></a><span class="visited"> </span>
<a id="L328"></a><span class="visited"> </span>
<a id="L329"></a><span > </span>
<a id="L330"></a><span > </span>
<a id="L331"></a><span > </span>
<a id="L332"></a><span class="visited"> </span>
<a id="L333"></a><span class="visited"> </span>
<a id="L334"></a><span class="visited"> </span>
<a id="L335"></a><span > </span>
<a id="L336"></a><span > </span>
<a id="L337"></a><span > </span>
<a id="L338"></a><span class="visited"> </span>
<a id="L339"></a><span class="visited"> </span>
<a id="L340"></a><span > </span>
<a id="L341"></a><span class="visited"> </span>
<a id="L342"></a><span > </span>
<a id="L343"></a><span > </span>
<a id="L344"></a><span > </span>
<a id="L345"></a><span class="visited"> </span>
<a id="L346"></a><span class="visited"> </span>
<a id="L347"></a><span class="visited"> </span>
<a id="L348"></a><span > </span>
<a id="L349"></a><span > </span>
<a id="L350"></a><span > </span>
<a id="L351"></a><span class="visited"> </span>
<a id="L352"></a><span class="visited"> </span>
<a id="L353"></a><span class="visited"> </span>
<a id="L354"></a><span > </span>
<a id="L355"></a><span > </span>
<a id="L356"></a><span > </span>
<a id="L357"></a><span class="visited"> </span>
<a id="L358"></a><span class="visited"> </span>
<a id="L359"></a><span > </span>
<a id="L360"></a><span > </span>
<a id="L361"></a><span > </span>
<a id="L362"></a><span > </span>
<a id="L363"></a><span > </span>
<a id="L364"></a><span > </span>
<a id="L365"></a><span class="visited"> </span>
<a id="L366"></a><span > </span>
<a id="L367"></a><span > </span>
<a id="L368"></a><span > </span>
<a id="L369"></a><span class="visited"> </span>
<a id="L370"></a><span class="visited"> </span>
<a id="L371"></a><span class="visited"> </span>
<a id="L372"></a><span > </span>
<a id="L373"></a><span > </span>
<a id="L374"></a><span > </span>
<a id="L375"></a><span class="visited"> </span>
<a id="L376"></a><span class="visited"> </span>
<a id="L377"></a><span class="visited"> </span>
<a id="L378"></a><span > </span>
<a id="L379"></a><span > </span>
<a id="L380"></a><span > </span>
<a id="L381"></a><span class="visited"> </span>
<a id="L382"></a><span class="visited"> </span>
<a id="L383"></a><span class="visited"> </span>
<a id="L384"></a><span > </span>
<a id="L385"></a><span > </span>
<a id="L386"></a><span > </span>
<a id="L387"></a><span class="visited"> </span>
<a id="L388"></a><span class="visited"> </span>
<a id="L389"></a><span class="visited"> </span>
<a id="L390"></a><span > </span>
<a id="L391"></a><span > </span>
<a id="L392"></a><span > </span>
<a id="L393"></a><span class="visited"> </span>
<a id="L394"></a><span class="visited"> </span>
<a id="L395"></a><span class="visited"> </span>
<a id="L396"></a><span > </span>
<a id="L397"></a><span > </span>
<a id="L398"></a><span > </span>
<a id="L399"></a><span class="visited"> </span>
<a id="L400"></a><span class="visited"> </span>
<a id="L401"></a><span class="visited"> </span>
<a id="L402"></a><span > </span>
<a id="L403"></a><span > </span>
<a id="L404"></a><span > </span>
<a id="L405"></a><span class="visited"> </span>
<a id="L406"></a><span class="visited"> </span>
<a id="L407"></a><span class="visited"> </span>
<a id="L408"></a><span > </span>
<a id="L409"></a><span > </span>
<a id="L410"></a><span > </span>
<a id="L411"></a><span class="visited"> </span>
<a id="L412"></a><span class="visited"> </span>
<a id="L413"></a><span > </span>
<a id="L414"></a><span > </span>
<a id="L415"></a><span > </span>
<a id="L416"></a><span > </span>
<a id="L417"></a><span > </span>
<a id="L418"></a><span > </span>
<a id="L419"></a><span class="visited"> </span>
<a id="L420"></a><span > </span>
<a id="L421"></a><span > </span>
<a id="L422"></a><span > </span>
<a id="L423"></a><span class="visited"> </span>
<a id="L424"></a><span class="visited"> </span>
<a id="L425"></a><span > </span>
<a id="L426"></a><span > </span>
<a id="L427"></a><span class="visited"> </span>
<a id="L428"></a><span > </span>
<a id="L429"></a><span > </span>
<a id="L430"></a><span > </span>
<a id="L431"></a><span class="visited"> </span>
<a id="L432"></a><span class="visited"> </span>
<a id="L433"></a><span > </span>
<a id="L434"></a><span > </span>
<a id="L435"></a><span > </span>
<a id="L436"></a><span class="visited"> </span>
<a id="L437"></a><span > </span>
<a id="L438"></a><span > </span>
<a id="L439"></a><span > </span>
<a id="L440"></a><span > </span>
<a id="L441"></a><span > </span>
<a id="L442"></a><span class="visited"> </span>
<a id="L443"></a><span class="visited"> </span>
<a id="L444"></a><span class="visited"> </span>
<a id="L445"></a><span > </span>
<a id="L446"></a><span > </span>
<a id="L447"></a><span > </span>
<a id="L448"></a><span class="visited"> </span>
<a id="L449"></a><span class="visited"> </span>
<a id="L450"></a><span > </span>
<a id="L451"></a><span > </span>
<a id="L452"></a><span > </span>
<a id="L453"></a><span > </span>
<a id="L454"></a><span > </span>
<a id="L455"></a><span > </span>
<a id="L456"></a><span > </span>
<a id="L457"></a><span > </span>
<a id="L458"></a><span > </span>
<a id="L459"></a><span class="visited"> </span>
<a id="L460"></a><span > </span>
<a id="L461"></a><span > </span>
<a id="L462"></a><span > </span>
<a id="L463"></a><span > </span>
<a id="L464"></a><span > </span>
<a id="L465"></a><span class="visited"> </span>
<a id="L466"></a><span class="visited"> </span>
<a id="L467"></a><span class="visited"> </span>
<a id="L468"></a><span > </span>
<a id="L469"></a><span > </span>
<a id="L470"></a><span > </span>
<a id="L471"></a><span class="visited"> </span>
<a id="L472"></a><span > </span>
<a id="L473"></a><span > </span>
<a id="L474"></a><span > </span>
<a id="L475"></a><span class="visited"> </span>
<a id="L476"></a><span > </span>
<a id="L477"></a><span > </span>
<a id="L478"></a><span > </span>
<a id="L479"></a><span > </span>
<a id="L480"></a><span > </span>
<a id="L481"></a><span > </span>
<a id="L482"></a><span > </span>
<a id="L483"></a><span > </span>
<a id="L484"></a><span > </span>
<a id="L485"></a><span > </span>
<a id="L486"></a><span > </span>
<a id="L487"></a><span > </span>
<a id="L488"></a><span > </span>
<a id="L489"></a><span > </span>
<a id="L490"></a><span > </span>
<a id="L491"></a><span > </span>
<a id="L492"></a><span class="visited"> </span>
<a id="L493"></a><span > </span>
<a id="L494"></a><span > </span>
<a id="L495"></a><span > </span>
<a id="L496"></a><span > </span>
<a id="L497"></a><span > </span>
<a id="L498"></a><span class="visited"> </span>
<a id="L499"></a><span class="visited"> </span>
<a id="L500"></a><span class="visited"> </span>
<a id="L501"></a><span > </span>
<a id="L502"></a><span > </span>
<a id="L503"></a><span > </span>
<a id="L504"></a><span class="visited"> </span>
<a id="L505"></a><span class="visited"> </span>
<a id="L506"></a><span > </span>
<a id="L507"></a><span > </span>
<a id="L508"></a><span > </span>
<a id="L509"></a><span > </span>
<a id="L510"></a><span > </span>
<a id="L511"></a><span > </span>
<a id="L512"></a><span > </span>
<a id="L513"></a><span > </span>
<a id="L514"></a><span > </span>
<a id="L515"></a><span > </span>
<a id="L516"></a><span > </span>
<a id="L517"></a><span > </span>
<a id="L518"></a><span class="visited"> </span>
<a id="L519"></a><span > </span>
<a id="L520"></a><span > </span>
<a id="L521"></a><span > </span>
<a id="L522"></a><span > </span>
<a id="L523"></a><span > </span>
<a id="L524"></a><span class="visited"> </span>
<a id="L525"></a><span class="visited"> </span>
<a id="L526"></a><span class="visited"> </span>
<a id="L527"></a><span > </span>
<a id="L528"></a><span > </span>
<a id="L529"></a><span > </span>
<a id="L530"></a><span class="visited"> </span>
<a id="L531"></a><span class="visited"> </span>
<a id="L532"></a><span > </span>
<a id="L533"></a><span > </span>
<a id="L534"></a><span > </span>
<a id="L535"></a><span > </span>
<a id="L536"></a><span class="visited"> </span>
<a id="L537"></a><span > </span>
<a id="L538"></a><span > </span>
<a id="L539"></a><span > </span>
<a id="L540"></a><span class="visited"> </span>
<a id="L541"></a><span class="visited"> </span>
<a id="L542"></a><span > </span>
<a id="L543"></a><span > </span>
<a id="L544"></a><span > </span>
<a id="L545"></a><span > </span>
<a id="L546"></a><span > </span>
<a id="L547"></a><span class="visited"> </span>
<a id="L548"></a><span > </span>
<a id="L549"></a><span > </span>
<a id="L550"></a><span > </span>
<a id="L551"></a><span class="visited"> </span>
<a id="L552"></a><span class="visited"> </span>
<a id="L553"></a><span > </span>
<a id="L554"></a><span > </span>
<a id="L555"></a><span > </span>
<a id="L556"></a><span class="visited"> </span>
<a id="L557"></a><span > </span>
<a id="L558"></a><span > </span>
<a id="L559"></a><span > </span>
<a id="L560"></a><span class="visited"> </span>
<a id="L561"></a><span > </span>
<a id="L562"></a><span > </span>
<a id="L563"></a><span > </span>
<a id="L564"></a><span > </span>
<a id="L565"></a><span > </span>
<a id="L566"></a><span > </span>
<a id="L567"></a><span > </span>
<a id="L568"></a><span > </span>
<a id="L569"></a><span > </span>
<a id="L570"></a><span > </span>
<a id="L571"></a><span > </span>
<a id="L572"></a><span > </span>
<a id="L573"></a><span class="visited"> </span>
<a id="L574"></a><span > </span>
<a id="L575"></a><span > </span>
<a id="L576"></a><span > </span>
<a id="L577"></a><span class="visited"> </span>
<a id="L578"></a><span > </span>
<a id="L579"></a><span > </span>
<a id="L580"></a><span > </span>
<a id="L581"></a><span class="visited"> </span>
<a id="L582"></a><span > </span>
<a id="L583"></a><span > </span>
<a id="L584"></a><span > </span>
<a id="L585"></a><span > </span>
<a id="L586"></a><span > </span>
<a id="L587"></a><span > </span>
<a id="L588"></a><span > </span>
<a id="L589"></a><span > </span>
<a id="L590"></a><span > </span>
<a id="L591"></a><span > </span>
<a id="L592"></a><span > </span>
<a id="L593"></a><span class="visited"> </span>
<a id="L594"></a><span > </span>
<a id="L595"></a><span > </span>
<a id="L596"></a><span > </span>
<a id="L597"></a><span class="visited"> </span>
<a id="L598"></a><span > </span>
<a id="L599"></a><span > </span>
<a id="L600"></a><span > </span>
<a id="L601"></a><span class="visited"> </span>
<a id="L602"></a><span > </span>
<a id="L603"></a><span > </span>
<a id="L604"></a><span > </span>
<a id="L605"></a><span > </span>
<a id="L606"></a><span > </span>
<a id="L607"></a><span > </span>
<a id="L608"></a><span > </span>
<a id="L609"></a><span > </span>
<a id="L610"></a><span > </span>
<a id="L611"></a><span > </span>
<a id="L612"></a><span > </span>
<a id="L613"></a><span > </span>
<a id="L614"></a><span > </span>
<a id="L615"></a><span > </span>
<a id="L616"></a><span class="visited"> </span>
<a id="L617"></a><span > </span>
<a id="L618"></a><span > </span>
<a id="L619"></a><span > </span>
<a id="L620"></a><span class="visited"> </span>
<a id="L621"></a><span > </span>
<a id="L622"></a><span > </span>
<a id="L623"></a><span > </span>
<a id="L624"></a><span > </span>
<a id="L625"></a><span class="visited"> </span>
<a id="L626"></a><span > </span>
<a id="L627"></a><span > </span>
<a id="L628"></a><span > </span>
<a id="L629"></a><span > </span>
<a id="L630"></a><span > </span>
<a id="L631"></a><span > </span>
<a id="L632"></a><span > </span>
<a id="L633"></a><span > </span>
<a id="L634"></a><span > </span>
<a id="L635"></a><span > </span>
<a id="L636"></a><span > </span>
<a id="L637"></a><span > </span>
<a id="L638"></a><span > </span>
<a id="L639"></a><span > </span>
<a id="L640"></a><span > </span>
<a id="L641"></a><span > </span>
<a id="L642"></a><span > </span>
<a id="L643"></a><span > </span>
<a id="L644"></a><span > </span>
<a id="L645"></a><span > </span>
<a id="L646"></a><span > </span>
<a id="L647"></a><span > </span>
<a id="L648"></a><span > </span>
<a id="L649"></a><span > </span>
<a id="L650"></a><span > </span>
<a id="L651"></a><span > </span>
<a id="L652"></a><span > </span>
<a id="L653"></a><span class="visited"> </span>
<a id="L654"></a><span > </span>
<a id="L655"></a><span > </span>
<a id="L656"></a><span > </span>
<a id="L657"></a><span class="visited"> </span>
<a id="L658"></a><span > </span>
<a id="L659"></a><span > </span>
<a id="L660"></a><span > </span>
<a id="L661"></a><span > </span>
<a id="L662"></a><span > </span>
<a id="L663"></a><span > </span>
<a id="L664"></a><span > </span>
<a id="L665"></a><span > </span>
<a id="L666"></a><span class="visited"> </span>
<a id="L667"></a><span > </span>
<a id="L668"></a><span > </span>
<a id="L669"></a><span > </span>
<a id="L670"></a><span > </span>
<a id="L671"></a><span > </span>
<a id="L672"></a><span > </span>
<a id="L673"></a><span > </span>
<a id="L674"></a><span > </span>
<a id="L675"></a><span > </span>
<a id="L676"></a><span > </span>
<a id="L677"></a><span > </span>
<a id="L678"></a><span > </span>
<a id="L679"></a><span > </span>
<a id="L680"></a><span > </span>
<a id="L681"></a><span > </span>
<a id="L682"></a><span > </span>
<a id="L683"></a><span > </span>
<a id="L684"></a><span > </span>
<a id="L685"></a><span > </span>
<a id="L686"></a><span > </span>
<a id="L687"></a><span > </span>
<a id="L688"></a><span > </span>
<a id="L689"></a><span > </span>
<a id="L690"></a><span > </span>
<a id="L691"></a><span > </span>
<a id="L692"></a><span > </span>
<a id="L693"></a><span > </span>
<a id="L694"></a><span > </span>
<a id="L695"></a><span > </span>
<a id="L696"></a><span > </span>
<a id="L697"></a><span > </span>
<a id="L698"></a><span > </span>
<a id="L699"></a><span > </span>
<a id="L700"></a><span > </span>
<a id="L701"></a><span > </span>
<a id="L702"></a><span > </span>
<a id="L703"></a><span > </span>
<a id="L704"></a><span > </span>
<a id="L705"></a><span > </span>
<a id="L706"></a><span > </span>
<a id="L707"></a><span > </span>
<a id="L708"></a><span > </span>
<a id="L709"></a><span > </span>
<a id="L710"></a><span > </span>
<a id="L711"></a><span > </span>
<a id="L712"></a><span > </span>
<a id="L713"></a><span class="visited"> </span>
<a id="L714"></a><span > </span>
<a id="L715"></a><span > </span>
<a id="L716"></a><span > </span>
<a id="L717"></a><span > </span>
<a id="L718"></a><span > </span>
<a id="L719"></a><span class="visited"> </span>
<a id="L720"></a><span class="visited"> </span>
<a id="L721"></a><span > </span>
<a id="L722"></a><span > </span>
<a id="L723"></a><span > </span>
<a id="L724"></a><span > </span>
<a id="L725"></a><span class="visited"> </span>
<a id="L726"></a><span > </span>
<a id="L727"></a><span > </span>
<a id="L728"></a><span > </span>
<a id="L729"></a><span class="visited"> </span>
<a id="L730"></a><span > </span>
<a id="L731"></a><span > </span>
<a id="L732"></a><span > </span>
<a id="L733"></a><span class="visited"> </span>
<a id="L734"></a><span > </span>
<a id="L735"></a><span > </span>
<a id="L736"></a><span > </span>
<a id="L737"></a><span > </span>
<a id="L738"></a><span > </span>
<a id="L739"></a><span > </span>
<a id="L740"></a><span > </span>
<a id="L741"></a><span > </span>
<a id="L742"></a><span > </span>
<a id="L743"></a><span > </span>
<a id="L744"></a><span class="visited"> </span>
<a id="L745"></a><span > </span>
</pre>
      </div>
      <div id="text-layer">
        <pre id="line-numbers">
<a href="#L1">  1</a>
<a href="#L2">  2</a>
<a href="#L3">  3</a>
<a href="#L4">  4</a>
<a href="#L5">  5</a>
<a href="#L6">  6</a>
<a href="#L7">  7</a>
<a href="#L8">  8</a>
<a href="#L9">  9</a>
<a href="#L10"> 10</a>
<a href="#L11"> 11</a>
<a href="#L12"> 12</a>
<a href="#L13"> 13</a>
<a href="#L14"> 14</a>
<a href="#L15"> 15</a>
<a href="#L16"> 16</a>
<a href="#L17"> 17</a>
<a href="#L18"> 18</a>
<a href="#L19"> 19</a>
<a href="#L20"> 20</a>
<a href="#L21"> 21</a>
<a href="#L22"> 22</a>
<a href="#L23"> 23</a>
<a href="#L24"> 24</a>
<a href="#L25"> 25</a>
<a href="#L26"> 26</a>
<a href="#L27"> 27</a>
<a href="#L28"> 28</a>
<a href="#L29"> 29</a>
<a href="#L30"> 30</a>
<a href="#L31"> 31</a>
<a href="#L32"> 32</a>
<a href="#L33"> 33</a>
<a href="#L34"> 34</a>
<a href="#L35"> 35</a>
<a href="#L36"> 36</a>
<a href="#L37"> 37</a>
<a href="#L38"> 38</a>
<a href="#L39"> 39</a>
<a href="#L40"> 40</a>
<a href="#L41"> 41</a>
<a href="#L42"> 42</a>
<a href="#L43"> 43</a>
<a href="#L44"> 44</a>
<a href="#L45"> 45</a>
<a href="#L46"> 46</a>
<a href="#L47"> 47</a>
<a href="#L48"> 48</a>
<a href="#L49"> 49</a>
<a href="#L50"> 50</a>
<a href="#L51"> 51</a>
<a href="#L52"> 52</a>
<a href="#L53"> 53</a>
<a href="#L54"> 54</a>
<a href="#L55"> 55</a>
<a href="#L56"> 56</a>
<a href="#L57"> 57</a>
<a href="#L58"> 58</a>
<a href="#L59"> 59</a>
<a href="#L60"> 60</a>
<a href="#L61"> 61</a>
<a href="#L62"> 62</a>
<a href="#L63"> 63</a>
<a href="#L64"> 64</a>
<a href="#L65"> 65</a>
<a href="#L66"> 66</a>
<a href="#L67"> 67</a>
<a href="#L68"> 68</a>
<a href="#L69"> 69</a>
<a href="#L70"> 70</a>
<a href="#L71"> 71</a>
<a href="#L72"> 72</a>
<a href="#L73"> 73</a>
<a href="#L74"> 74</a>
<a href="#L75"> 75</a>
<a href="#L76"> 76</a>
<a href="#L77"> 77</a>
<a href="#L78"> 78</a>
<a href="#L79"> 79</a>
<a href="#L80"> 80</a>
<a href="#L81"> 81</a>
<a href="#L82"> 82</a>
<a href="#L83"> 83</a>
<a href="#L84"> 84</a>
<a href="#L85"> 85</a>
<a href="#L86"> 86</a>
<a href="#L87"> 87</a>
<a href="#L88"> 88</a>
<a href="#L89"> 89</a>
<a href="#L90"> 90</a>
<a href="#L91"> 91</a>
<a href="#L92"> 92</a>
<a href="#L93"> 93</a>
<a href="#L94"> 94</a>
<a href="#L95"> 95</a>
<a href="#L96"> 96</a>
<a href="#L97"> 97</a>
<a href="#L98"> 98</a>
<a href="#L99"> 99</a>
<a href="#L100">100</a>
<a href="#L101">101</a>
<a href="#L102">102</a>
<a href="#L103">103</a>
<a href="#L104">104</a>
<a href="#L105">105</a>
<a href="#L106">106</a>
<a href="#L107">107</a>
<a href="#L108">108</a>
<a href="#L109">109</a>
<a href="#L110">110</a>
<a href="#L111">111</a>
<a href="#L112">112</a>
<a href="#L113">113</a>
<a href="#L114">114</a>
<a href="#L115">115</a>
<a href="#L116">116</a>
<a href="#L117">117</a>
<a href="#L118">118</a>
<a href="#L119">119</a>
<a href="#L120">120</a>
<a href="#L121">121</a>
<a href="#L122">122</a>
<a href="#L123">123</a>
<a href="#L124">124</a>
<a href="#L125">125</a>
<a href="#L126">126</a>
<a href="#L127">127</a>
<a href="#L128">128</a>
<a href="#L129">129</a>
<a href="#L130">130</a>
<a href="#L131">131</a>
<a href="#L132">132</a>
<a href="#L133">133</a>
<a href="#L134">134</a>
<a href="#L135">135</a>
<a href="#L136">136</a>
<a href="#L137">137</a>
<a href="#L138">138</a>
<a href="#L139">139</a>
<a href="#L140">140</a>
<a href="#L141">141</a>
<a href="#L142">142</a>
<a href="#L143">143</a>
<a href="#L144">144</a>
<a href="#L145">145</a>
<a href="#L146">146</a>
<a href="#L147">147</a>
<a href="#L148">148</a>
<a href="#L149">149</a>
<a href="#L150">150</a>
<a href="#L151">151</a>
<a href="#L152">152</a>
<a href="#L153">153</a>
<a href="#L154">154</a>
<a href="#L155">155</a>
<a href="#L156">156</a>
<a href="#L157">157</a>
<a href="#L158">158</a>
<a href="#L159">159</a>
<a href="#L160">160</a>
<a href="#L161">161</a>
<a href="#L162">162</a>
<a href="#L163">163</a>
<a href="#L164">164</a>
<a href="#L165">165</a>
<a href="#L166">166</a>
<a href="#L167">167</a>
<a href="#L168">168</a>
<a href="#L169">169</a>
<a href="#L170">170</a>
<a href="#L171">171</a>
<a href="#L172">172</a>
<a href="#L173">173</a>
<a href="#L174">174</a>
<a href="#L175">175</a>
<a href="#L176">176</a>
<a href="#L177">177</a>
<a href="#L178">178</a>
<a href="#L179">179</a>
<a href="#L180">180</a>
<a href="#L181">181</a>
<a href="#L182">182</a>
<a href="#L183">183</a>
<a href="#L184">184</a>
<a href="#L185">185</a>
<a href="#L186">186</a>
<a href="#L187">187</a>
<a href="#L188">188</a>
<a href="#L189">189</a>
<a href="#L190">190</a>
<a href="#L191">191</a>
<a href="#L192">192</a>
<a href="#L193">193</a>
<a href="#L194">194</a>
<a href="#L195">195</a>
<a href="#L196">196</a>
<a href="#L197">197</a>
<a href="#L198">198</a>
<a href="#L199">199</a>
<a href="#L200">200</a>
<a href="#L201">201</a>
<a href="#L202">202</a>
<a href="#L203">203</a>
<a href="#L204">204</a>
<a href="#L205">205</a>
<a href="#L206">206</a>
<a href="#L207">207</a>
<a href="#L208">208</a>
<a href="#L209">209</a>
<a href="#L210">210</a>
<a href="#L211">211</a>
<a href="#L212">212</a>
<a href="#L213">213</a>
<a href="#L214">214</a>
<a href="#L215">215</a>
<a href="#L216">216</a>
<a href="#L217">217</a>
<a href="#L218">218</a>
<a href="#L219">219</a>
<a href="#L220">220</a>
<a href="#L221">221</a>
<a href="#L222">222</a>
<a href="#L223">223</a>
<a href="#L224">224</a>
<a href="#L225">225</a>
<a href="#L226">226</a>
<a href="#L227">227</a>
<a href="#L228">228</a>
<a href="#L229">229</a>
<a href="#L230">230</a>
<a href="#L231">231</a>
<a href="#L232">232</a>
<a href="#L233">233</a>
<a href="#L234">234</a>
<a href="#L235">235</a>
<a href="#L236">236</a>
<a href="#L237">237</a>
<a href="#L238">238</a>
<a href="#L239">239</a>
<a href="#L240">240</a>
<a href="#L241">241</a>
<a href="#L242">242</a>
<a href="#L243">243</a>
<a href="#L244">244</a>
<a href="#L245">245</a>
<a href="#L246">246</a>
<a href="#L247">247</a>
<a href="#L248">248</a>
<a href="#L249">249</a>
<a href="#L250">250</a>
<a href="#L251">251</a>
<a href="#L252">252</a>
<a href="#L253">253</a>
<a href="#L254">254</a>
<a href="#L255">255</a>
<a href="#L256">256</a>
<a href="#L257">257</a>
<a href="#L258">258</a>
<a href="#L259">259</a>
<a href="#L260">260</a>
<a href="#L261">261</a>
<a href="#L262">262</a>
<a href="#L263">263</a>
<a href="#L264">264</a>
<a href="#L265">265</a>
<a href="#L266">266</a>
<a href="#L267">267</a>
<a href="#L268">268</a>
<a href="#L269">269</a>
<a href="#L270">270</a>
<a href="#L271">271</a>
<a href="#L272">272</a>
<a href="#L273">273</a>
<a href="#L274">274</a>
<a href="#L275">275</a>
<a href="#L276">276</a>
<a href="#L277">277</a>
<a href="#L278">278</a>
<a href="#L279">279</a>
<a href="#L280">280</a>
<a href="#L281">281</a>
<a href="#L282">282</a>
<a href="#L283">283</a>
<a href="#L284">284</a>
<a href="#L285">285</a>
<a href="#L286">286</a>
<a href="#L287">287</a>
<a href="#L288">288</a>
<a href="#L289">289</a>
<a href="#L290">290</a>
<a href="#L291">291</a>
<a href="#L292">292</a>
<a href="#L293">293</a>
<a href="#L294">294</a>
<a href="#L295">295</a>
<a href="#L296">296</a>
<a href="#L297">297</a>
<a href="#L298">298</a>
<a href="#L299">299</a>
<a href="#L300">300</a>
<a href="#L301">301</a>
<a href="#L302">302</a>
<a href="#L303">303</a>
<a href="#L304">304</a>
<a href="#L305">305</a>
<a href="#L306">306</a>
<a href="#L307">307</a>
<a href="#L308">308</a>
<a href="#L309">309</a>
<a href="#L310">310</a>
<a href="#L311">311</a>
<a href="#L312">312</a>
<a href="#L313">313</a>
<a href="#L314">314</a>
<a href="#L315">315</a>
<a href="#L316">316</a>
<a href="#L317">317</a>
<a href="#L318">318</a>
<a href="#L319">319</a>
<a href="#L320">320</a>
<a href="#L321">321</a>
<a href="#L322">322</a>
<a href="#L323">323</a>
<a href="#L324">324</a>
<a href="#L325">325</a>
<a href="#L326">326</a>
<a href="#L327">327</a>
<a href="#L328">328</a>
<a href="#L329">329</a>
<a href="#L330">330</a>
<a href="#L331">331</a>
<a href="#L332">332</a>
<a href="#L333">333</a>
<a href="#L334">334</a>
<a href="#L335">335</a>
<a href="#L336">336</a>
<a href="#L337">337</a>
<a href="#L338">338</a>
<a href="#L339">339</a>
<a href="#L340">340</a>
<a href="#L341">341</a>
<a href="#L342">342</a>
<a href="#L343">343</a>
<a href="#L344">344</a>
<a href="#L345">345</a>
<a href="#L346">346</a>
<a href="#L347">347</a>
<a href="#L348">348</a>
<a href="#L349">349</a>
<a href="#L350">350</a>
<a href="#L351">351</a>
<a href="#L352">352</a>
<a href="#L353">353</a>
<a href="#L354">354</a>
<a href="#L355">355</a>
<a href="#L356">356</a>
<a href="#L357">357</a>
<a href="#L358">358</a>
<a href="#L359">359</a>
<a href="#L360">360</a>
<a href="#L361">361</a>
<a href="#L362">362</a>
<a href="#L363">363</a>
<a href="#L364">364</a>
<a href="#L365">365</a>
<a href="#L366">366</a>
<a href="#L367">367</a>
<a href="#L368">368</a>
<a href="#L369">369</a>
<a href="#L370">370</a>
<a href="#L371">371</a>
<a href="#L372">372</a>
<a href="#L373">373</a>
<a href="#L374">374</a>
<a href="#L375">375</a>
<a href="#L376">376</a>
<a href="#L377">377</a>
<a href="#L378">378</a>
<a href="#L379">379</a>
<a href="#L380">380</a>
<a href="#L381">381</a>
<a href="#L382">382</a>
<a href="#L383">383</a>
<a href="#L384">384</a>
<a href="#L385">385</a>
<a href="#L386">386</a>
<a href="#L387">387</a>
<a href="#L388">388</a>
<a href="#L389">389</a>
<a href="#L390">390</a>
<a href="#L391">391</a>
<a href="#L392">392</a>
<a href="#L393">393</a>
<a href="#L394">394</a>
<a href="#L395">395</a>
<a href="#L396">396</a>
<a href="#L397">397</a>
<a href="#L398">398</a>
<a href="#L399">399</a>
<a href="#L400">400</a>
<a href="#L401">401</a>
<a href="#L402">402</a>
<a href="#L403">403</a>
<a href="#L404">404</a>
<a href="#L405">405</a>
<a href="#L406">406</a>
<a href="#L407">407</a>
<a href="#L408">408</a>
<a href="#L409">409</a>
<a href="#L410">410</a>
<a href="#L411">411</a>
<a href="#L412">412</a>
<a href="#L413">413</a>
<a href="#L414">414</a>
<a href="#L415">415</a>
<a href="#L416">416</a>
<a href="#L417">417</a>
<a href="#L418">418</a>
<a href="#L419">419</a>
<a href="#L420">420</a>
<a href="#L421">421</a>
<a href="#L422">422</a>
<a href="#L423">423</a>
<a href="#L424">424</a>
<a href="#L425">425</a>
<a href="#L426">426</a>
<a href="#L427">427</a>
<a href="#L428">428</a>
<a href="#L429">429</a>
<a href="#L430">430</a>
<a href="#L431">431</a>
<a href="#L432">432</a>
<a href="#L433">433</a>
<a href="#L434">434</a>
<a href="#L435">435</a>
<a href="#L436">436</a>
<a href="#L437">437</a>
<a href="#L438">438</a>
<a href="#L439">439</a>
<a href="#L440">440</a>
<a href="#L441">441</a>
<a href="#L442">442</a>
<a href="#L443">443</a>
<a href="#L444">444</a>
<a href="#L445">445</a>
<a href="#L446">446</a>
<a href="#L447">447</a>
<a href="#L448">448</a>
<a href="#L449">449</a>
<a href="#L450">450</a>
<a href="#L451">451</a>
<a href="#L452">452</a>
<a href="#L453">453</a>
<a href="#L454">454</a>
<a href="#L455">455</a>
<a href="#L456">456</a>
<a href="#L457">457</a>
<a href="#L458">458</a>
<a href="#L459">459</a>
<a href="#L460">460</a>
<a href="#L461">461</a>
<a href="#L462">462</a>
<a href="#L463">463</a>
<a href="#L464">464</a>
<a href="#L465">465</a>
<a href="#L466">466</a>
<a href="#L467">467</a>
<a href="#L468">468</a>
<a href="#L469">469</a>
<a href="#L470">470</a>
<a href="#L471">471</a>
<a href="#L472">472</a>
<a href="#L473">473</a>
<a href="#L474">474</a>
<a href="#L475">475</a>
<a href="#L476">476</a>
<a href="#L477">477</a>
<a href="#L478">478</a>
<a href="#L479">479</a>
<a href="#L480">480</a>
<a href="#L481">481</a>
<a href="#L482">482</a>
<a href="#L483">483</a>
<a href="#L484">484</a>
<a href="#L485">485</a>
<a href="#L486">486</a>
<a href="#L487">487</a>
<a href="#L488">488</a>
<a href="#L489">489</a>
<a href="#L490">490</a>
<a href="#L491">491</a>
<a href="#L492">492</a>
<a href="#L493">493</a>
<a href="#L494">494</a>
<a href="#L495">495</a>
<a href="#L496">496</a>
<a href="#L497">497</a>
<a href="#L498">498</a>
<a href="#L499">499</a>
<a href="#L500">500</a>
<a href="#L501">501</a>
<a href="#L502">502</a>
<a href="#L503">503</a>
<a href="#L504">504</a>
<a href="#L505">505</a>
<a href="#L506">506</a>
<a href="#L507">507</a>
<a href="#L508">508</a>
<a href="#L509">509</a>
<a href="#L510">510</a>
<a href="#L511">511</a>
<a href="#L512">512</a>
<a href="#L513">513</a>
<a href="#L514">514</a>
<a href="#L515">515</a>
<a href="#L516">516</a>
<a href="#L517">517</a>
<a href="#L518">518</a>
<a href="#L519">519</a>
<a href="#L520">520</a>
<a href="#L521">521</a>
<a href="#L522">522</a>
<a href="#L523">523</a>
<a href="#L524">524</a>
<a href="#L525">525</a>
<a href="#L526">526</a>
<a href="#L527">527</a>
<a href="#L528">528</a>
<a href="#L529">529</a>
<a href="#L530">530</a>
<a href="#L531">531</a>
<a href="#L532">532</a>
<a href="#L533">533</a>
<a href="#L534">534</a>
<a href="#L535">535</a>
<a href="#L536">536</a>
<a href="#L537">537</a>
<a href="#L538">538</a>
<a href="#L539">539</a>
<a href="#L540">540</a>
<a href="#L541">541</a>
<a href="#L542">542</a>
<a href="#L543">543</a>
<a href="#L544">544</a>
<a href="#L545">545</a>
<a href="#L546">546</a>
<a href="#L547">547</a>
<a href="#L548">548</a>
<a href="#L549">549</a>
<a href="#L550">550</a>
<a href="#L551">551</a>
<a href="#L552">552</a>
<a href="#L553">553</a>
<a href="#L554">554</a>
<a href="#L555">555</a>
<a href="#L556">556</a>
<a href="#L557">557</a>
<a href="#L558">558</a>
<a href="#L559">559</a>
<a href="#L560">560</a>
<a href="#L561">561</a>
<a href="#L562">562</a>
<a href="#L563">563</a>
<a href="#L564">564</a>
<a href="#L565">565</a>
<a href="#L566">566</a>
<a href="#L567">567</a>
<a href="#L568">568</a>
<a href="#L569">569</a>
<a href="#L570">570</a>
<a href="#L571">571</a>
<a href="#L572">572</a>
<a href="#L573">573</a>
<a href="#L574">574</a>
<a href="#L575">575</a>
<a href="#L576">576</a>
<a href="#L577">577</a>
<a href="#L578">578</a>
<a href="#L579">579</a>
<a href="#L580">580</a>
<a href="#L581">581</a>
<a href="#L582">582</a>
<a href="#L583">583</a>
<a href="#L584">584</a>
<a href="#L585">585</a>
<a href="#L586">586</a>
<a href="#L587">587</a>
<a href="#L588">588</a>
<a href="#L589">589</a>
<a href="#L590">590</a>
<a href="#L591">591</a>
<a href="#L592">592</a>
<a href="#L593">593</a>
<a href="#L594">594</a>
<a href="#L595">595</a>
<a href="#L596">596</a>
<a href="#L597">597</a>
<a href="#L598">598</a>
<a href="#L599">599</a>
<a href="#L600">600</a>
<a href="#L601">601</a>
<a href="#L602">602</a>
<a href="#L603">603</a>
<a href="#L604">604</a>
<a href="#L605">605</a>
<a href="#L606">606</a>
<a href="#L607">607</a>
<a href="#L608">608</a>
<a href="#L609">609</a>
<a href="#L610">610</a>
<a href="#L611">611</a>
<a href="#L612">612</a>
<a href="#L613">613</a>
<a href="#L614">614</a>
<a href="#L615">615</a>
<a href="#L616">616</a>
<a href="#L617">617</a>
<a href="#L618">618</a>
<a href="#L619">619</a>
<a href="#L620">620</a>
<a href="#L621">621</a>
<a href="#L622">622</a>
<a href="#L623">623</a>
<a href="#L624">624</a>
<a href="#L625">625</a>
<a href="#L626">626</a>
<a href="#L627">627</a>
<a href="#L628">628</a>
<a href="#L629">629</a>
<a href="#L630">630</a>
<a href="#L631">631</a>
<a href="#L632">632</a>
<a href="#L633">633</a>
<a href="#L634">634</a>
<a href="#L635">635</a>
<a href="#L636">636</a>
<a href="#L637">637</a>
<a href="#L638">638</a>
<a href="#L639">639</a>
<a href="#L640">640</a>
<a href="#L641">641</a>
<a href="#L642">642</a>
<a href="#L643">643</a>
<a href="#L644">644</a>
<a href="#L645">645</a>
<a href="#L646">646</a>
<a href="#L647">647</a>
<a href="#L648">648</a>
<a href="#L649">649</a>
<a href="#L650">650</a>
<a href="#L651">651</a>
<a href="#L652">652</a>
<a href="#L653">653</a>
<a href="#L654">654</a>
<a href="#L655">655</a>
<a href="#L656">656</a>
<a href="#L657">657</a>
<a href="#L658">658</a>
<a href="#L659">659</a>
<a href="#L660">660</a>
<a href="#L661">661</a>
<a href="#L662">662</a>
<a href="#L663">663</a>
<a href="#L664">664</a>
<a href="#L665">665</a>
<a href="#L666">666</a>
<a href="#L667">667</a>
<a href="#L668">668</a>
<a href="#L669">669</a>
<a href="#L670">670</a>
<a href="#L671">671</a>
<a href="#L672">672</a>
<a href="#L673">673</a>
<a href="#L674">674</a>
<a href="#L675">675</a>
<a href="#L676">676</a>
<a href="#L677">677</a>
<a href="#L678">678</a>
<a href="#L679">679</a>
<a href="#L680">680</a>
<a href="#L681">681</a>
<a href="#L682">682</a>
<a href="#L683">683</a>
<a href="#L684">684</a>
<a href="#L685">685</a>
<a href="#L686">686</a>
<a href="#L687">687</a>
<a href="#L688">688</a>
<a href="#L689">689</a>
<a href="#L690">690</a>
<a href="#L691">691</a>
<a href="#L692">692</a>
<a href="#L693">693</a>
<a href="#L694">694</a>
<a href="#L695">695</a>
<a href="#L696">696</a>
<a href="#L697">697</a>
<a href="#L698">698</a>
<a href="#L699">699</a>
<a href="#L700">700</a>
<a href="#L701">701</a>
<a href="#L702">702</a>
<a href="#L703">703</a>
<a href="#L704">704</a>
<a href="#L705">705</a>
<a href="#L706">706</a>
<a href="#L707">707</a>
<a href="#L708">708</a>
<a href="#L709">709</a>
<a href="#L710">710</a>
<a href="#L711">711</a>
<a href="#L712">712</a>
<a href="#L713">713</a>
<a href="#L714">714</a>
<a href="#L715">715</a>
<a href="#L716">716</a>
<a href="#L717">717</a>
<a href="#L718">718</a>
<a href="#L719">719</a>
<a href="#L720">720</a>
<a href="#L721">721</a>
<a href="#L722">722</a>
<a href="#L723">723</a>
<a href="#L724">724</a>
<a href="#L725">725</a>
<a href="#L726">726</a>
<a href="#L727">727</a>
<a href="#L728">728</a>
<a href="#L729">729</a>
<a href="#L730">730</a>
<a href="#L731">731</a>
<a href="#L732">732</a>
<a href="#L733">733</a>
<a href="#L734">734</a>
<a href="#L735">735</a>
<a href="#L736">736</a>
<a href="#L737">737</a>
<a href="#L738">738</a>
<a href="#L739">739</a>
<a href="#L740">740</a>
<a href="#L741">741</a>
<a href="#L742">742</a>
<a href="#L743">743</a>
<a href="#L744">744</a>
<a href="#L745">745</a>
</pre>
<pre><code class="ocaml">(** Copyright 2023-2024, Grigory Aseev and Matvey Kalashnikov *)

(** SPDX-License-Identifier: LGPL-2.1-or-later *)

open Angstrom
open Ast
open Base
module Format = Stdlib.Format

let parse_str p s = <span data-count="69">p</span>arse_string ~consume:All p s

let is_whitespace = function
  | <span data-count="5896">'</span> ' | <span data-count="606">'</span>\n' | <span data-count="0">'</span>\t' | <span data-count="0">'</span>\r' -&gt; true
  | <span data-count="15142">_</span> -&gt; false
;;

let is_digit = function
  | <span data-count="170">'</span>0' .. '9' -&gt; true
  | <span data-count="2650">_</span> -&gt; false
;;

let is_aletter = function
  | <span data-count="2013">'</span>a' .. 'z' -&gt; true
  | <span data-count="1587">_</span> -&gt; false
;;

let is_cletter = function
  | <span data-count="0">'</span>A' .. 'Z' -&gt; true
  | <span data-count="1036">_</span> -&gt; false
;;

let is_underscore = function
  | <span data-count="1587">c</span> -&gt; Char.equal c '_'
;;

let is_id_char = function
  | <span data-count="2038">c</span> -&gt; is_digi<span data-count="2038">t</span> <span data-count="35">c</span> || is_alette<span data-count="2003">r</span> <span data-count="967">c</span> || is_clette<span data-count="1036">r</span> <span data-count="0">c</span> || is_underscore c
;;

let is_keyword = function
  | <span data-count="12">"</span>let" | <span data-count="0">"</span>rec" | <span data-count="124">"</span>fun" | <span data-count="19">"</span>in" | <span data-count="72">"</span>if" | <span data-count="0">"</span>then" | <span data-count="13">"</span>else" | <span data-count="4">"</span>true" | <span data-count="2">"</span>false" -&gt; true
  | <span data-count="800">_</span> -&gt; false
;;

let chainl1 e op =
  <span data-count="1578">l</span>et rec go acc = <span data-count="2085">l</span>ift<span data-count="2085">2</span> (fun f x -&gt; <span data-count="158">f</span> acc x) op e &gt;&gt;<span data-count="2085">=</span> go &lt;|&gt; retur<span data-count="2085">n</span> acc in
  e &gt;&gt;= fun init -&gt; <span data-count="1927">g</span>o init
;;

let empty = take_whil<span data-count="33">e</span> is_whitespace
let empty1 = take_while<span data-count="33">1</span> is_whitespace
let token s = <span data-count="132">e</span>mpty *&gt; s
let token1 s = <span data-count="613">e</span>mpty1 *&gt; s
let str_token s = <span data-count="7037">e</span>mpty *&gt; strin<span data-count="7037">g</span> s
let str_token1 s = <span data-count="812">e</span>mpty1 *&gt; strin<span data-count="812">g</span> s
let pparens p = <span data-count="2898">s</span>tr_toke<span data-count="2898">n</span> "(" *<span data-count="2898">&gt;</span> p &lt;* str_toke<span data-count="2898">n</span> ")"
let parrow = str_toke<span data-count="33">n</span> "-&gt;"
let pbinding = str_toke<span data-count="33">n</span> "let"
let pwild = str_toke<span data-count="33">n</span> "_"

(**  Const parsers *)
let pcint =
  let ps = token (optio<span data-count="33">n</span> "" (str_toke<span data-count="33">n</span> "-" &lt;|<span data-count="33">&gt;</span> str_toke<span data-count="33">n</span> "+")) in
  <span data-count="33">l</span>et pd = take_while1 is_digit in
  <span data-count="33">l</span>ift<span data-count="33">2</span> (fun sign digit -&gt; <span data-count="122">c</span>onstr_cint (Int.of_strin<span data-count="122">g</span> @@ sign ^ digit)) ps pd
;;

let pcbool =
  lif<span data-count="33">t</span> (fun b -&gt; <span data-count="5">c</span>onstr_cbool @@ Bool.of_strin<span data-count="5">g</span> b) (str_toke<span data-count="33">n</span> "false" &lt;|<span data-count="33">&gt;</span> str_toke<span data-count="33">n</span> "true")
;;

let pcunit = pparen<span data-count="33">s</span> @@ (str_toke<span data-count="33">n</span> "" *<span data-count="33">&gt;</span> retur<span data-count="33">n</span> CUnit)
let pconst = toke<span data-count="33">n</span> (choic<span data-count="33">e</span> [ pcint; pcbool; pcunit ])

(**  Identifier parsers *)
let ident is_good_entry =
  <span data-count="33">l</span>et pchar = satisfy is_id_char in
  <span data-count="33">e</span>mpty *<span data-count="33">&gt;</span> satisf<span data-count="33">y</span> is_good_entry
  &gt;&gt;= fun h -&gt;
  <span data-count="1046">m</span>an<span data-count="1046">y</span> pchar
  &gt;&gt;= fun tl -&gt;
  <span data-count="1046">l</span>et id = String.of_char_list (h :: tl) in
  <span data-count="1046">i</span>f is_keyword id
  then <span data-count="246">f</span>ail ("Unexpected keyword '" ^ id ^ "' in binding")
  else <span data-count="800">i</span>f String.equal id "_"
  then <span data-count="0">f</span>ail "Wildcard \"_\" not expected"
  else <span data-count="800">r</span>eturn id
;;

let pident =
  let is_entry = function
    | <span data-count="1597">c</span> -&gt; is_alette<span data-count="1597">r</span> <span data-count="1046">c</span> || is_underscore c
  in
  iden<span data-count="33">t</span> is_entry
;;

(**  Pattern parsers *)

let ppwild = constr_pwild &lt;$<span data-count="33">&gt;</span> pwild
let ppconst = constr_pconst &lt;$<span data-count="33">&gt;</span> pconst
let ppvar = constr_pvar &lt;$<span data-count="33">&gt;</span> pident
let pattern = fi<span data-count="33">x</span> @@ fun m -&gt; <span data-count="28">c</span>hoic<span data-count="28">e</span> [ ppwild; ppconst; ppvar ] &lt;|&gt; pparen<span data-count="28">s</span> @@ m

(**  Operation parsers *)

let pop ch op = <span data-count="429">s</span>tr_toke<span data-count="429">n</span> ch *&gt; retur<span data-count="429">n</span> (constr_ebino<span data-count="429">p</span> op)
let pmulti = choic<span data-count="33">e</span> [ po<span data-count="33">p</span> "*" Mul; po<span data-count="33">p</span> "/" Div; po<span data-count="33">p</span> "%" Mod ]
let padd = po<span data-count="33">p</span> "+" Add &lt;|<span data-count="33">&gt;</span> po<span data-count="33">p</span> "-" Sub
let pcomp = choic<span data-count="33">e</span> [ po<span data-count="33">p</span> "&gt;=" Geq; po<span data-count="33">p</span> "&gt;" Gre; po<span data-count="33">p</span> "&lt;=" Leq; po<span data-count="33">p</span> "&lt;" Less ]
let peq = po<span data-count="33">p</span> "=" Eq &lt;|<span data-count="33">&gt;</span> po<span data-count="33">p</span> "&lt;&gt;" Neq
let pconj = po<span data-count="33">p</span> "&amp;&amp;" And
let pdisj = po<span data-count="33">p</span> "||" Or

(** Expr parsers *)

type edispatch =
  { evar : edispatch -&gt; expr t
  ; econst : edispatch -&gt; expr t
  ; op : edispatch -&gt; expr t
  ; condition : edispatch -&gt; expr t
  ; func : edispatch -&gt; expr t
  ; bind_in : edispatch -&gt; expr t
  ; app : edispatch -&gt; expr t
  ; expr : edispatch -&gt; expr t
  }

let peconst = constr_econst &lt;$<span data-count="33">&gt;</span> pconst
let pevar = pident &gt;&gt;<span data-count="33">|</span> constr_evar
let pfun_args = fi<span data-count="33">x</span> @@ fun p -&gt; <span data-count="28">m</span>an<span data-count="28">y</span> pattern &lt;|&gt; pparen<span data-count="28">s</span> @@ p
let pfun_args1 = fi<span data-count="33">x</span> @@ fun p -&gt; <span data-count="9">m</span>any<span data-count="9">1</span> pattern &lt;|&gt; pparen<span data-count="9">s</span> @@ p
let pparens_only ps = <span data-count="859">p</span>parens @@ choic<span data-count="859">e</span> ps

let plet_body pargs pexpr =
  <span data-count="315">t</span>oken<span data-count="315">1</span> pargs
  &gt;&gt;= fun args -&gt; <span data-count="80">s</span>tr_toke<span data-count="80">n</span> "=" *<span data-count="80">&gt;</span> pexpr &gt;&gt;| fun expr -&gt; <span data-count="80">c</span>onstr_efun args expr
;;

let plet_body_without_args pexpr =
  <span data-count="287">s</span>tr_toke<span data-count="287">n</span> "=" *<span data-count="287">&gt;</span> pexpr &gt;&gt;| fun expr -&gt; <span data-count="0">c</span>onstr_efun [] expr
;;

let pbind_with_option_rec = pbinding *<span data-count="33">&gt;</span> optio<span data-count="33">n</span> false (str_token<span data-count="33">1</span> "rec " &gt;&gt;<span data-count="33">|</span> fun _ -&gt; <span data-count="21">t</span>rue)
let pname_func = pident &gt;&gt;<span data-count="33">|</span> fun name -&gt; <span data-count="80">n</span>ame
let pbody_with_args pack = <span data-count="315">p</span>let_body pfun_args (pack.exp<span data-count="315">r</span> pack)

let pack =
  let expr pack =
    <span data-count="1443">c</span>hoice
      [ pack.o<span data-count="1443">p</span> pack
      ; pack.ap<span data-count="1443">p</span> pack
      ; pack.conditio<span data-count="1443">n</span> pack
      ; pack.fun<span data-count="1443">c</span> pack
      ; pack.bind_i<span data-count="1443">n</span> pack
      ]
  in
  let econst pack = <span data-count="823">f</span>ix @@ fun _ -&gt; <span data-count="262">p</span>econst &lt;|&gt; pparen<span data-count="262">s</span> @@ pack.econs<span data-count="262">t</span> pack in
  let evar pack = <span data-count="1514">f</span>ix @@ fun _ -&gt; <span data-count="655">p</span>evar &lt;|&gt; pparen<span data-count="655">s</span> @@ pack.eva<span data-count="655">r</span> pack in
  let op_parsers pack =
    <span data-count="263">c</span>hoice
      [ pack.bind_i<span data-count="263">n</span> pack
      ; pack.ap<span data-count="263">p</span> pack
      ; pparens_onl<span data-count="263">y</span> [ pack.o<span data-count="263">p</span> pack; pack.conditio<span data-count="263">n</span> pack ]
      ; pack.eva<span data-count="263">r</span> pack
      ; pack.econs<span data-count="263">t</span> pack
      ]
  in
  let cond_bool_parsers pack =
    <span data-count="86">c</span>hoice [ pack.o<span data-count="86">p</span> pack; pack.bind_i<span data-count="86">n</span> pack; pack.ap<span data-count="86">p</span> pack; pack.conditio<span data-count="86">n</span> pack ]
  in
  let app_func_parsers pack =
    <span data-count="298">c</span>hoice
      [ pack.eva<span data-count="298">r</span> pack
      ; pparens_onl<span data-count="298">y</span>
          [ pack.conditio<span data-count="298">n</span> pack; pack.fun<span data-count="298">c</span> pack; pack.ap<span data-count="298">p</span> pack; pack.bind_i<span data-count="298">n</span> pack ]
      ]
  in
  let app_args_parsers pack =
    <span data-count="298">c</span>hoice
      [ pparens_onl<span data-count="298">y</span>
          [ pack.o<span data-count="298">p</span> pack
          ; pack.conditio<span data-count="298">n</span> pack
          ; pack.fun<span data-count="298">c</span> pack
          ; pack.ap<span data-count="298">p</span> pack
          ; pack.bind_i<span data-count="298">n</span> pack
          ]
      ; pack.eva<span data-count="298">r</span> pack
      ; pack.econs<span data-count="298">t</span> pack
      ]
  in
  let op pack =
    <span data-count="2353">f</span>ix
    @@ fun _ -&gt;
    <span data-count="263">l</span>et multi = chainl1 (op_parser<span data-count="263">s</span> pack) pmulti in
    <span data-count="263">l</span>et add = chainl1 multi padd in
    <span data-count="263">l</span>et comp = chainl1 add pcomp in
    <span data-count="263">l</span>et eq = chainl1 comp peq in
    <span data-count="263">l</span>et conj = chainl1 eq pconj in
    <span data-count="263">c</span>hainl<span data-count="263">1</span> conj pdisj &lt;|&gt; pparen<span data-count="263">s</span> @@ pack.o<span data-count="263">p</span> pack
  in
  let condition pack =
    <span data-count="2474">f</span>ix
    @@ fun _ -&gt;
    <span data-count="86">l</span>ift<span data-count="86">3</span>
      constr_eif
      (str_toke<span data-count="86">n</span> "if" *<span data-count="86">&gt;</span> cond_bool_parser<span data-count="86">s</span> pack)
      (str_token<span data-count="86">1</span> "then" *<span data-count="86">&gt;</span> exp<span data-count="86">r</span> pack)
      (str_token<span data-count="86">1</span> "else" *<span data-count="86">&gt;</span> exp<span data-count="86">r</span> pack)
    &lt;|&gt; pparen<span data-count="86">s</span> @@ pack.conditio<span data-count="86">n</span> pack
  in
  let func pack =
    <span data-count="2101">f</span>ix
    @@ fun _ -&gt;
    <span data-count="62">l</span>ift<span data-count="62">2</span> constr_efun (str_toke<span data-count="62">n</span> "fun" *<span data-count="62">&gt;</span> pfun_args1) (parrow *<span data-count="62">&gt;</span> exp<span data-count="62">r</span> pack)
    &lt;|&gt; pparen<span data-count="62">s</span> @@ pack.fun<span data-count="62">c</span> pack
  in
  let app pack =
    <span data-count="2686">f</span>ix
    @@ fun _ -&gt;
    <span data-count="298">l</span>ift<span data-count="298">2</span> constr_eapp (app_func_parser<span data-count="298">s</span> pack) (many<span data-count="298">1</span> (token<span data-count="298">1</span> @@ app_args_parser<span data-count="298">s</span> pack))
    &lt;|&gt; pparen<span data-count="298">s</span> @@ pack.ap<span data-count="298">p</span> pack
  in
  let pbind_without_rec = pbinding *&gt; retur<span data-count="33">n</span> false in
  <span data-count="33">l</span>et punderscore_name = str_token<span data-count="33">1</span> "_" *&gt; retur<span data-count="33">n</span> "_" in
  <span data-count="33">l</span>et pbody_without_args pack = <span data-count="287">p</span>let_body_without_args (exp<span data-count="287">r</span> pack) in
  let bind_in pack =
    <span data-count="2675">f</span>ix
    @@ fun _ -&gt;
    <span data-count="287">l</span>ift<span data-count="287">4</span>
      constr_eletin
      pbind_with_option_rec
      pname_func
      (pbody_with_arg<span data-count="287">s</span> pack)
      (str_token<span data-count="287">1</span> "in" *<span data-count="287">&gt;</span> exp<span data-count="287">r</span> pack)
    &lt;|<span data-count="287">&gt;</span> lift<span data-count="287">4</span>
          constr_eletin
          pbind_without_rec
          punderscore_name
          (pbody_without_arg<span data-count="287">s</span> pack)
          (str_token<span data-count="287">1</span> "in" *<span data-count="287">&gt;</span> exp<span data-count="287">r</span> pack)
    &lt;|&gt; pparen<span data-count="287">s</span> @@ pack.bind_i<span data-count="287">n</span> pack
  in
  { evar; econst; op; condition; func; bind_in; app; expr }
;;

let expr = pack.exp<span data-count="33">r</span> pack

(**  Binding parser *)
let bind =
  fi<span data-count="33">x</span>
  @@ fun m -&gt;
  <span data-count="28">l</span>ift<span data-count="28">3</span> constr_elet pbind_with_option_rec pname_func (pbody_with_arg<span data-count="28">s</span> pack)
  &lt;|&gt; pparen<span data-count="28">s</span> @@ m
;;

(**  Program parser *)
let pprogram = many<span data-count="33">1</span> (toke<span data-count="33">n</span> bind &lt;<span data-count="33">*</span> choic<span data-count="33">e</span> [ toke<span data-count="33">n</span> (str_toke<span data-count="33">n</span> ";;"); empty ])

let parse str = <span data-count="27">p</span>arse_str pprogram (String.stri<span data-count="27">p</span> str)

(**  TESTS *)

let show_parsed_result str parser show =
  <span data-count="42">m</span>atch parse_str parser str with
  | <span data-count="42">O</span>k res -&gt; Format.printf "%s" (sho<span data-count="42">w</span> res)
  | <span data-count="0">E</span>rror e -&gt; Format.printf "Error%s" e
;;

(**  Consts tests *)

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "777" pconst show_const;
  <span data-count="1">[</span>%expect {| (CInt 777) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "-777" pconst show_const;
  <span data-count="1">[</span>%expect {| (CInt -777) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "true" pconst show_const;
  <span data-count="1">[</span>%expect {| (CBool true) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "false" pconst show_const;
  <span data-count="1">[</span>%expect {| (CBool false) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "()" pconst show_const;
  <span data-count="1">[</span>%expect {| CUnit |}<span data-count="67">]</span>
;;

(**  Pattern tests *)

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "777" pattern show_pattern;
  <span data-count="1">[</span>%expect {|
    (PConst (CInt 777)) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "a" pattern show_pattern;
  <span data-count="1">[</span>%expect {|
    (PVar "a") |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "()" pattern show_pattern;
  <span data-count="1">[</span>%expect {|
    (PConst CUnit) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "_" pattern show_pattern;
  <span data-count="1">[</span>%expect {|
    PWild |}<span data-count="67">]</span>
;;

(**  Expression tests *)

(**  Binary operations *)

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x + 1" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Add, (EVar "x"), (EConst (CInt 1)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x - 1" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Sub, (EVar "x"), (EConst (CInt 1)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x + y - 1" expr show_expr;
  <span data-count="1">[</span>%expect
    {|
    (EBinOp (Sub, (EBinOp (Add, (EVar "x"), (EVar "y"))), (EConst (CInt 1)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x * y / z" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Div, (EBinOp (Mul, (EVar "x"), (EVar "y"))), (EVar "z"))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x * (y / z)" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Mul, (EVar "x"), (EBinOp (Div, (EVar "y"), (EVar "z"))))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "(x + y) * (z - y) / (y * x)  *  m" expr show_expr;
  <span data-count="1">[</span>%expect
    {|
    (EBinOp (Mul,
       (EBinOp (Div,
          (EBinOp (Mul, (EBinOp (Add, (EVar "x"), (EVar "y"))),
             (EBinOp (Sub, (EVar "z"), (EVar "y"))))),
          (EBinOp (Mul, (EVar "y"), (EVar "x"))))),
       (EVar "m"))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x % 100" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Mod, (EVar "x"), (EConst (CInt 100)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x &lt; 1" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Less, (EVar "x"), (EConst (CInt 1)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x &gt; 1" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Gre, (EVar "x"), (EConst (CInt 1)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x &lt;= 1" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Leq, (EVar "x"), (EConst (CInt 1)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x &gt;= 1" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Geq, (EVar "x"), (EConst (CInt 1)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x = y" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Eq, (EVar "x"), (EVar "y"))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x &lt;&gt; 1" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EBinOp (Neq, (EVar "x"), (EConst (CInt 1)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "true || x &gt; 1 || y &gt; 1 || false" expr show_expr;
  <span data-count="1">[</span>%expect
    {|
    (EBinOp (Or,
       (EBinOp (Or,
          (EBinOp (Or, (EConst (CBool true)),
             (EBinOp (Gre, (EVar "x"), (EConst (CInt 1)))))),
          (EBinOp (Gre, (EVar "y"), (EConst (CInt 1)))))),
       (EConst (CBool false)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x &amp;&amp; y || z &amp;&amp; w" expr show_expr;
  <span data-count="1">[</span>%expect
    {|
    (EBinOp (Or, (EBinOp (And, (EVar "x"), (EVar "y"))),
       (EBinOp (And, (EVar "z"), (EVar "w"))))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "x || y &amp;&amp; z || w" expr show_expr;
  <span data-count="1">[</span>%expect
    {|
    (EBinOp (Or,
       (EBinOp (Or, (EVar "x"), (EBinOp (And, (EVar "y"), (EVar "z"))))),
       (EVar "w"))) |}<span data-count="67">]</span>
;;

(**  Conditions *)

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "if true then 1 else 2" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EIf ((EConst (CBool true)), (EConst (CInt 1)), (EConst (CInt 2)))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "if x % 5 = 0 then x * 5 else (x - x % 5) * 5" expr show_expr;
  <span data-count="1">[</span>%expect
    {|
    (EIf (
       (EBinOp (Eq, (EBinOp (Mod, (EVar "x"), (EConst (CInt 5)))),
          (EConst (CInt 0)))),
       (EBinOp (Mul, (EVar "x"), (EConst (CInt 5)))),
       (EBinOp (Mul,
          (EBinOp (Sub, (EVar "x"), (EBinOp (Mod, (EVar "x"), (EConst (CInt 5))))
             )),
          (EConst (CInt 5))))
       )) |}<span data-count="67">]</span>
;;

(**  Lambda functions *)

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "fun x -&gt; x" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EFun ((PVar "x"), (EVar "x"))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result
    "fun x y z-&gt; fun t -&gt; if t &gt; 0 then (x + y + z - t) / t else 0"
    expr
    show_expr;
  <span data-count="1">[</span>%expect
    {|
    (EFun ((PVar "x"),
       (EFun ((PVar "y"),
          (EFun ((PVar "z"),
             (EFun ((PVar "t"),
                (EIf ((EBinOp (Gre, (EVar "t"), (EConst (CInt 0)))),
                   (EBinOp (Div,
                      (EBinOp (Sub,
                         (EBinOp (Add, (EBinOp (Add, (EVar "x"), (EVar "y"))),
                            (EVar "z"))),
                         (EVar "t"))),
                      (EVar "t"))),
                   (EConst (CInt 0))))
                ))
             ))
          ))
       )) |}<span data-count="67">]</span>
;;

(**  Applications *)

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "f x" expr show_expr;
  <span data-count="1">[</span>%expect {|
    (EApp ((EVar "f"), (EVar "x"))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "(fun x y z -&gt; x * 100) x y z" expr show_expr;
  <span data-count="1">[</span>%expect
    {|
    (EApp (
       (EApp (
          (EApp (
             (EFun ((PVar "x"),
                (EFun ((PVar "y"),
                   (EFun ((PVar "z"),
                      (EBinOp (Mul, (EVar "x"), (EConst (CInt 100))))))
                   ))
                )),
             (EVar "x"))),
          (EVar "y"))),
       (EVar "z"))) |}<span data-count="67">]</span>
;;

(**  Let and let rec *)

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "let f x = x" pprogram show_program;
  <span data-count="1">[</span>%expect {|
    [(ELet (false, "f", (EFun ((PVar "x"), (EVar "x")))))] |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "let bind x f = f x" pprogram show_program;
  <span data-count="1">[</span>%expect
    {|
    [(ELet (false, "bind",
        (EFun ((PVar "x"), (EFun ((PVar "f"), (EApp ((EVar "f"), (EVar "x")))))))
        ))
      ] |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "let mult x = fun y -&gt; x * y" pprogram show_program;
  <span data-count="1">[</span>%expect
    {|
    [(ELet (false, "mult",
        (EFun ((PVar "x"),
           (EFun ((PVar "y"), (EBinOp (Mul, (EVar "x"), (EVar "y")))))))
        ))
      ] |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "let x = 10" pprogram show_program;
  <span data-count="1">[</span>%expect {| [(ELet (false, "x", (EConst (CInt 10))))] |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result
    "let rec factorial n =\n  if n &lt;= 1\n  then 1\n  else factorial (n - 1) * n"
    pprogram
    show_program;
  <span data-count="1">[</span>%expect
    {|
    [(ELet (true, "factorial",
        (EFun ((PVar "n"),
           (EIf ((EBinOp (Leq, (EVar "n"), (EConst (CInt 1)))),
              (EConst (CInt 1)),
              (EBinOp (Mul,
                 (EApp ((EVar "factorial"),
                    (EBinOp (Sub, (EVar "n"), (EConst (CInt 1)))))),
                 (EVar "n")))
              ))
           ))
        ))
      ] |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result
    "let rec series n = if n = 1 then 1 else n + series (n - 1)"
    pprogram
    show_program;
  <span data-count="1">[</span>%expect
    {|
    [(ELet (true, "series",
        (EFun ((PVar "n"),
           (EIf ((EBinOp (Eq, (EVar "n"), (EConst (CInt 1)))), (EConst (CInt 1)),
              (EBinOp (Add, (EVar "n"),
                 (EApp ((EVar "series"),
                    (EBinOp (Sub, (EVar "n"), (EConst (CInt 1))))))
                 ))
              ))
           ))
        ))
      ] |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result
    "let rec fibonacci n = if n &lt;= 1 then 1 else fibonacci (n - 1) + fibonacci (n - 2)"
    pprogram
    show_program;
  <span data-count="1">[</span>%expect
    {|
    [(ELet (true, "fibonacci",
        (EFun ((PVar "n"),
           (EIf ((EBinOp (Leq, (EVar "n"), (EConst (CInt 1)))),
              (EConst (CInt 1)),
              (EBinOp (Add,
                 (EApp ((EVar "fibonacci"),
                    (EBinOp (Sub, (EVar "n"), (EConst (CInt 1)))))),
                 (EApp ((EVar "fibonacci"),
                    (EBinOp (Sub, (EVar "n"), (EConst (CInt 2))))))
                 ))
              ))
           ))
        ))
      ] |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result
    "let fack1 k n m = k (n * m);; let rec fack n k = if n &lt;= 1 then k 1 else fack (n-1) \
     (fack1 k n);; let id x = x;; let fac n = fack n id"
    pprogram
    show_program;
  <span data-count="1">[</span>%expect
    {|
    [(ELet (false, "fack1",
        (EFun ((PVar "k"),
           (EFun ((PVar "n"),
              (EFun ((PVar "m"),
                 (EApp ((EVar "k"), (EBinOp (Mul, (EVar "n"), (EVar "m")))))))
              ))
           ))
        ));
      (ELet (true, "fack",
         (EFun ((PVar "n"),
            (EFun ((PVar "k"),
               (EIf ((EBinOp (Leq, (EVar "n"), (EConst (CInt 1)))),
                  (EApp ((EVar "k"), (EConst (CInt 1)))),
                  (EApp (
                     (EApp ((EVar "fack"),
                        (EBinOp (Sub, (EVar "n"), (EConst (CInt 1)))))),
                     (EApp ((EApp ((EVar "fack1"), (EVar "k"))), (EVar "n")))))
                  ))
               ))
            ))
         ));
      (ELet (false, "id", (EFun ((PVar "x"), (EVar "x")))));
      (ELet (false, "fac",
         (EFun ((PVar "n"),
            (EApp ((EApp ((EVar "fack"), (EVar "n"))), (EVar "id")))))
         ))
      ] |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result
    "let id x = x;;\n\
    \     let acc1 acc x y = acc (x + y);;\n\
    \     let acc2 fib_func n acc x = fib_func (n - 2) (acc1 acc x);;\n\
    \     let rec fibo_cps n acc = if n &lt; 3 then acc 1 else fibo_cps (n - 1) (acc2 \
     fibo_cps n acc);;\n\
    \     let fibo n = fibo_cps n id"
    pprogram
    show_program;
  <span data-count="1">[</span>%expect
    {|
    [(ELet (false, "id", (EFun ((PVar "x"), (EVar "x")))));
      (ELet (false, "acc1",
         (EFun ((PVar "acc"),
            (EFun ((PVar "x"),
               (EFun ((PVar "y"),
                  (EApp ((EVar "acc"), (EBinOp (Add, (EVar "x"), (EVar "y")))))))
               ))
            ))
         ));
      (ELet (false, "acc2",
         (EFun ((PVar "fib_func"),
            (EFun ((PVar "n"),
               (EFun ((PVar "acc"),
                  (EFun ((PVar "x"),
                     (EApp (
                        (EApp ((EVar "fib_func"),
                           (EBinOp (Sub, (EVar "n"), (EConst (CInt 2)))))),
                        (EApp ((EApp ((EVar "acc1"), (EVar "acc"))), (EVar "x")))
                        ))
                     ))
                  ))
               ))
            ))
         ));
      (ELet (true, "fibo_cps",
         (EFun ((PVar "n"),
            (EFun ((PVar "acc"),
               (EIf ((EBinOp (Less, (EVar "n"), (EConst (CInt 3)))),
                  (EApp ((EVar "acc"), (EConst (CInt 1)))),
                  (EApp (
                     (EApp ((EVar "fibo_cps"),
                        (EBinOp (Sub, (EVar "n"), (EConst (CInt 1)))))),
                     (EApp (
                        (EApp ((EApp ((EVar "acc2"), (EVar "fibo_cps"))),
                           (EVar "n"))),
                        (EVar "acc")))
                     ))
                  ))
               ))
            ))
         ));
      (ELet (false, "fibo",
         (EFun ((PVar "n"),
            (EApp ((EApp ((EVar "fibo_cps"), (EVar "n"))), (EVar "id")))))
         ))
      ] |}<span data-count="67">]</span>
;;

(**  Let in and let rec in *)

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result "let sum x = fun y -&gt; x + y in sum 10 5" expr show_expr;
  <span data-count="1">[</span>%expect
    {|
    (ELetIn (false, "sum",
       (EFun ((PVar "x"),
          (EFun ((PVar "y"), (EBinOp (Add, (EVar "x"), (EVar "y"))))))),
       (EApp ((EApp ((EVar "sum"), (EConst (CInt 10)))), (EConst (CInt 5)))))) |}<span data-count="67">]</span>
;;

let%expect_test _ =
  <span data-count="1">s</span>how_parsed_result
    "let rec fact x = if x &lt;= 1 then 1 else fact (x - 1) * x in fact 10"
    expr
    show_expr;
  <span data-count="1">[</span>%expect
    {|
    (ELetIn (true, "fact",
       (EFun ((PVar "x"),
          (EIf ((EBinOp (Leq, (EVar "x"), (EConst (CInt 1)))), (EConst (CInt 1)),
             (EBinOp (Mul,
                (EApp ((EVar "fact"),
                   (EBinOp (Sub, (EVar "x"), (EConst (CInt 1)))))),
                (EVar "x")))
             ))
          )),
       (EApp ((EVar "fact"), (EConst (CInt 10)))))) |}<span data-count="67">]</span>
;;
</code></pre>
      </div>
    </div>
    <script src="../coverage.js"></script>
  </body>
</html>
